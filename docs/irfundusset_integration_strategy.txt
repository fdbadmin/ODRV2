IRFundusSet Integration Strategy
=================================

CURRENT STATUS:
---------------
✓ Manually integrated: ODIR (6,392) + HYGD (747) + RFMID1 (1,920) = 9,059 images
✓ Achieved +239.5% glaucoma improvement (397 → 1,348 samples)
✓ Created unified dataset with proper disease label mapping

IRFUNDUSSET OPPORTUNITY:
------------------------
IRFundusSet provides 10 curated, harmonized datasets with consistent 'is_normal' labels:

Dataset Overlap Analysis:
1. ✓ ODIR (7,000) - ALREADY HAVE (6,392 processed)
2. ★ EyePACS (35,108) - NEW! Massive DR dataset from USA
3. ★ iDRID (516) - NEW! DR/DME grading from India  
4. ★ PAPILA (488) - NEW! Glaucoma dataset from Spain
5. ○ KAGGLE39 (1,000) - NEW! Multi-label from China
6. ○ STARE (397) - Vessel segmentation (42 labels, USA)
7. ○ CHASEDB1 (28) - Vessel segmentation (1 label, UK)
8. ○ HRF (45) - High-res vessel (3 labels, EU)
9. ○ FIVES (800) - Multi-condition (4 labels, China)
10. ○ RETINA_Cataracts (601) - Cataracts (4 labels)

★ = High priority (directly relevant diseases)
○ = Medium priority (may need label mapping)

NOT IN IRFUNDUSSET (but we have):
- HYGD (747 glaucoma images)
- RFMID1 (1,920 multi-disease)
- RFMID2 (509 labels, images missing)


INTEGRATION STRATEGY:
---------------------

OPTION 1: Download Key IRFundusSet Datasets + Merge with Existing
------------------------------------------------------------------
Pros:
- Get EyePACS (35K DR images!) - massive improvement for DR
- Get PAPILA (488 glaucoma) - adds to glaucoma strength
- Get iDRID (516 DR/DME) - high-quality Indian dataset
- Keep HYGD and RFMID1 (not in IRFundusSet)
- Total potential: 35,108 + 516 + 488 + 9,059 = ~45,000 images!

Cons:
- Need to download EyePACS, PAPILA, iDRID manually
- Need to map IRFundusSet's harmonization to our pipeline
- Large storage requirement (EyePACS is ~88GB)

Steps:
1. Download EyePACS, PAPILA, iDRID from their sources
2. Use IRFundusSet to harmonize and extract their 'is_normal' labels
3. Map IRFundusSet labels to ODIR 7-class system
4. Merge with existing unified dataset (ODIR + HYGD + RFMID1)
5. Retrain ensemble on combined ~45K images


OPTION 2: Use IRFundusSet for ODIR Only + Keep Manual Integration
------------------------------------------------------------------
Pros:
- No new downloads needed
- Leverage IRFundusSet's curated 'is_normal' label for ODIR
- Keep existing HYGD + RFMID1 integration
- More manageable dataset size (~9K images)

Cons:
- Miss out on EyePACS's 35K DR images
- Miss PAPILA's glaucoma dataset
- Smaller overall improvement

Steps:
1. Use IRFundusSet to get ODIR's curated 'is_normal' labels
2. Keep existing unified dataset structure
3. Optionally refine ODIR labels based on IRFundusSet curation
4. Continue with current 9,059 image dataset


OPTION 3: Full IRFundusSet Integration (All 10 Datasets)
---------------------------------------------------------
Pros:
- Maximum dataset size (46,064 images)
- Fully harmonized across all sources
- Consistent 'is_normal' label
- Geographic and demographic diversity

Cons:
- Need to download all 10 datasets (~150GB total)
- Time-consuming download process
- May include datasets with minimal disease info (STARE, CHASEDB - vessel only)
- Need to map 'is_normal' to 7-class ODIR system
- Will lose HYGD and RFMID1 (not in IRFundusSet)

Steps:
1. Download all 10 source datasets
2. Run IRFundusSet harmonization pipeline
3. Map to ODIR 7-class disease labels (may be lossy)
4. Integrate HYGD + RFMID1 separately
5. Retrain on ~50K images


RECOMMENDED APPROACH:
---------------------

** OPTION 1 - Targeted High-Value Integration **

Priority Downloads:
1. EyePACS (35,108 images, DR grading 0-4) - HIGHEST PRIORITY
   - Source: https://www.kaggle.com/c/diabetic-retinopathy-detection
   - ~88GB download
   - Maps directly to Label_D (diabetic retinopathy)
   - Will increase DR from 2,628 → 37,736 samples (+1,335%!)

2. PAPILA (488 images, glaucoma) - HIGH PRIORITY  
   - Source: https://www.nature.com/articles/s41598-022-09096-4
   - Small download (~150MB)
   - Maps directly to Label_G (glaucoma)
   - Will increase glaucoma from 1,348 → 1,836 samples (+36%)

3. iDRID (516 images, DR + DME grading) - MEDIUM PRIORITY
   - Source: https://ieee-dataport.org/open-access/indian-diabetic-retinopathy-image-dataset-idrid
   - Small download (~2GB)
   - Maps to Label_D (DR) and possibly Label_O (DME as other)
   - Will add 516 high-quality annotated images from India


Expected Combined Dataset:
- ODIR: 6,392
- HYGD: 747  
- RFMID1: 1,920
- EyePACS: 35,108
- PAPILA: 488
- iDRID: 516
- **TOTAL: ~45,000 images**

Disease Improvements:
- DR: 2,628 → 37,736 (+1,335%)
- Glaucoma: 1,348 → 1,836 (+36%)
- Other diseases: Maintained from current unified dataset


IMPLEMENTATION PLAN:
--------------------

Phase 1: Download Priority Datasets (THIS WEEK)
1. Download EyePACS from Kaggle (requires Kaggle account + API)
2. Download PAPILA from paper repository
3. Download iDRID from IEEE DataPort

Phase 2: IRFundusSet Harmonization (NEXT WEEK)
1. Create IRFundusSet config with 3 new datasets
2. Run harmonization to get preprocessed images + labels
3. Extract disease labels from each dataset
4. Map to ODIR 7-class system

Phase 3: Merge with Existing Unified Dataset
1. Create updated create_unified_dataset.py script
2. Add EyePACS, PAPILA, iDRID to existing ODIR + HYGD + RFMID1
3. Generate new unified CSV with ~45K images
4. Create train/val/test splits (80/10/10)

Phase 4: Retrain Ensemble
1. Update training config for larger dataset
2. Adjust batch size and learning rate for scale
3. Train 5-fold ensemble on ~45K images
4. Evaluate on all external test sets (HYGD, ACRIMA)
5. Expect major improvements in DR and glaucoma detection


DATASET DOWNLOAD LINKS:
-----------------------
1. EyePACS: https://www.kaggle.com/c/diabetic-retinopathy-detection/data
   - Requires: Kaggle account, competition rules acceptance
   - Size: ~88GB (35,108 images)
   
2. PAPILA: https://figshare.com/articles/dataset/PAPILA/14798004
   - Direct download available
   - Size: ~150MB (488 images)
   
3. iDRID: https://ieee-dataport.org/open-access/indian-diabetic-retinopathy-image-dataset-idrid
   - Requires: IEEE account registration
   - Size: ~2GB (516 images)


STORAGE REQUIREMENTS:
---------------------
Current: ~5GB (ODIR + HYGD + RFMID1 + models)
After Phase 1: ~95GB (+ EyePACS, PAPILA, iDRID raw)
After Harmonization: ~110GB (+ preprocessed versions)
Recommended: 150GB free space minimum


NEXT IMMEDIATE STEPS:
---------------------
1. Set up Kaggle API credentials for EyePACS download
2. Create download automation script
3. Begin EyePACS download (will take 1-2 hours)
4. While downloading, prepare IRFundusSet config file
5. Test IRFundusSet harmonization on ODIR first


EXPECTED OUTCOME:
-----------------
- ~45,000 training images (5x current size)
- DR detection improvement: +1,335% training samples
- Glaucoma detection improvement: +36% on top of current +239%
- Geographic diversity: China, USA, Spain, India, UK
- Demographic diversity: Multiple age groups and ethnicities
- Much better generalization on external test sets
